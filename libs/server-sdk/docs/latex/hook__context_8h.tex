\hypertarget{hook__context_8h}{}\doxysection{include/launchdarkly/server\+\_\+side/bindings/c/hook\+\_\+context.h File Reference}
\label{hook__context_8h}\index{include/launchdarkly/server\_side/bindings/c/hook\_context.h@{include/launchdarkly/server\_side/bindings/c/hook\_context.h}}


C bindings for passing caller data to hooks.  


{\ttfamily \#include $<$launchdarkly/bindings/c/export.\+h$>$}\newline
Include dependency graph for hook\+\_\+context.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=204pt]{hook__context_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{hook__context_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct p\+\_\+\+LDHook\+Context $\ast$ \mbox{\hyperlink{hook__context_8h_a7a8d7d6a6046c3925628518e971bb3d7}{LDHook\+Context}}
\begin{DoxyCompactList}\small\item\em Opaque hook context handle. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{hook__context_8h_a6752ad02ed116d4f21a2dcb7a790f5a9}{LDHook\+Context\+\_\+\+New}} (void)
\begin{DoxyCompactList}\small\item\em Create a new hook context. \end{DoxyCompactList}\item 
\mbox{\hyperlink{hook__context_8h_a68ab42283ecf0f6460169ffa2c80b858}{LDHook\+Context\+\_\+\+Set}} (\mbox{\hyperlink{hook__context_8h_a7a8d7d6a6046c3925628518e971bb3d7}{LDHook\+Context}} hook\+\_\+context, char const $\ast$key, void const $\ast$value)
\begin{DoxyCompactList}\small\item\em Set a pointer value in the hook context. \end{DoxyCompactList}\item 
\mbox{\hyperlink{hook__context_8h_ae756d970c922a4450aa08e9db942e2ba}{LDHook\+Context\+\_\+\+Get}} (\mbox{\hyperlink{hook__context_8h_a7a8d7d6a6046c3925628518e971bb3d7}{LDHook\+Context}} hook\+\_\+context, char const $\ast$key, void const $\ast$$\ast$out\+\_\+value)
\begin{DoxyCompactList}\small\item\em Get a pointer value from the hook context. \end{DoxyCompactList}\item 
\mbox{\hyperlink{hook__context_8h_a643483a64077b2d3cc894828ddbd5591}{LDHook\+Context\+\_\+\+Free}} (\mbox{\hyperlink{hook__context_8h_a7a8d7d6a6046c3925628518e971bb3d7}{LDHook\+Context}} hook\+\_\+context)
\begin{DoxyCompactList}\small\item\em Free a hook context. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
C bindings for passing caller data to hooks. 

Hook\+Context allows application code to pass arbitrary data through to hooks. This is useful for propagating context like Open\+Telemetry span parents in asynchronous web frameworks where thread-\/local storage doesn\textquotesingle{}t work.

USAGE\+: Most applications don\textquotesingle{}t need Hook\+Context. Only use it when you need to pass data from the evaluation call site to your hooks, such as\+:
\begin{DoxyItemize}
\item Open\+Telemetry span parents in async frameworks
\item Request IDs for distributed tracing
\item Custom metadata for logging
\end{DoxyItemize}

LIFETIME AND OWNERSHIP\+:
\begin{DoxyItemize}
\item Hook context must remain valid for the duration of the variation call
\item Data stored in hook context must be managed by the caller
\item Hook context can be stack-\/allocated and freed after the variation call 
\end{DoxyItemize}

\doxysubsection{Typedef Documentation}
\mbox{\Hypertarget{hook__context_8h_a7a8d7d6a6046c3925628518e971bb3d7}\label{hook__context_8h_a7a8d7d6a6046c3925628518e971bb3d7}} 
\index{hook\_context.h@{hook\_context.h}!LDHookContext@{LDHookContext}}
\index{LDHookContext@{LDHookContext}!hook\_context.h@{hook\_context.h}}
\doxysubsubsection{\texorpdfstring{LDHookContext}{LDHookContext}}
{\footnotesize\ttfamily typedef struct p\+\_\+\+LDHook\+Context$\ast$ \mbox{\hyperlink{hook__context_8h_a7a8d7d6a6046c3925628518e971bb3d7}{LDHook\+Context}}}



Opaque hook context handle. 

Created by \mbox{\hyperlink{hook__context_8h_a6752ad02ed116d4f21a2dcb7a790f5a9}{LDHook\+Context\+\_\+\+New()}}, must be freed with \mbox{\hyperlink{hook__context_8h_a643483a64077b2d3cc894828ddbd5591}{LDHook\+Context\+\_\+\+Free()}}. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{hook__context_8h_a643483a64077b2d3cc894828ddbd5591}\label{hook__context_8h_a643483a64077b2d3cc894828ddbd5591}} 
\index{hook\_context.h@{hook\_context.h}!LDHookContext\_Free@{LDHookContext\_Free}}
\index{LDHookContext\_Free@{LDHookContext\_Free}!hook\_context.h@{hook\_context.h}}
\doxysubsubsection{\texorpdfstring{LDHookContext\_Free()}{LDHookContext\_Free()}}
{\footnotesize\ttfamily LDHook\+Context\+\_\+\+Free (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{hook__context_8h_a7a8d7d6a6046c3925628518e971bb3d7}{LDHook\+Context}}}]{hook\+\_\+context }\end{DoxyParamCaption})}



Free a hook context. 


\begin{DoxyParams}{Parameters}
{\em hook\+\_\+context} & Hook context to free. May be NULL (no-\/op). \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{hook__context_8h_ae756d970c922a4450aa08e9db942e2ba}\label{hook__context_8h_ae756d970c922a4450aa08e9db942e2ba}} 
\index{hook\_context.h@{hook\_context.h}!LDHookContext\_Get@{LDHookContext\_Get}}
\index{LDHookContext\_Get@{LDHookContext\_Get}!hook\_context.h@{hook\_context.h}}
\doxysubsubsection{\texorpdfstring{LDHookContext\_Get()}{LDHookContext\_Get()}}
{\footnotesize\ttfamily LDHook\+Context\+\_\+\+Get (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{hook__context_8h_a7a8d7d6a6046c3925628518e971bb3d7}{LDHook\+Context}}}]{hook\+\_\+context,  }\item[{char const $\ast$}]{key,  }\item[{void const $\ast$$\ast$}]{out\+\_\+value }\end{DoxyParamCaption})}



Get a pointer value from the hook context. 

Retrieves an application-\/specific pointer previously stored with \mbox{\hyperlink{hook__context_8h_a68ab42283ecf0f6460169ffa2c80b858}{LDHook\+Context\+\_\+\+Set()}}.

USAGE IN HOOKS\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void}* span\_parent;}
\DoxyCodeLine{\textcolor{keywordflow}{if} (\mbox{\hyperlink{hook__context_8h_ae756d970c922a4450aa08e9db942e2ba}{LDHookContext\_Get}}(hook\_ctx, \textcolor{stringliteral}{"{}span\_parent"{}}, \&span\_parent)) \{}
\DoxyCodeLine{    \textcolor{comment}{// Use span\_parent}}
\DoxyCodeLine{\}}

\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em hook\+\_\+context} & Hook context. Must not be NULL. \\
\hline
{\em key} & Key to look up. Must be null-\/terminated UTF-\/8 string. Must not be NULL. \\
\hline
{\em out\+\_\+value} & Pointer to receive the value. Must not be NULL. Set to NULL if key not found. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if key was found, false otherwise. 
\end{DoxyReturn}
\mbox{\Hypertarget{hook__context_8h_a6752ad02ed116d4f21a2dcb7a790f5a9}\label{hook__context_8h_a6752ad02ed116d4f21a2dcb7a790f5a9}} 
\index{hook\_context.h@{hook\_context.h}!LDHookContext\_New@{LDHookContext\_New}}
\index{LDHookContext\_New@{LDHookContext\_New}!hook\_context.h@{hook\_context.h}}
\doxysubsubsection{\texorpdfstring{LDHookContext\_New()}{LDHookContext\_New()}}
{\footnotesize\ttfamily LDHook\+Context\+\_\+\+New (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Create a new hook context. 

\begin{DoxyReturn}{Returns}
New hook context. Must be freed with \mbox{\hyperlink{hook__context_8h_a643483a64077b2d3cc894828ddbd5591}{LDHook\+Context\+\_\+\+Free()}}. 
\end{DoxyReturn}
\mbox{\Hypertarget{hook__context_8h_a68ab42283ecf0f6460169ffa2c80b858}\label{hook__context_8h_a68ab42283ecf0f6460169ffa2c80b858}} 
\index{hook\_context.h@{hook\_context.h}!LDHookContext\_Set@{LDHookContext\_Set}}
\index{LDHookContext\_Set@{LDHookContext\_Set}!hook\_context.h@{hook\_context.h}}
\doxysubsubsection{\texorpdfstring{LDHookContext\_Set()}{LDHookContext\_Set()}}
{\footnotesize\ttfamily LDHook\+Context\+\_\+\+Set (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{hook__context_8h_a7a8d7d6a6046c3925628518e971bb3d7}{LDHook\+Context}}}]{hook\+\_\+context,  }\item[{char const $\ast$}]{key,  }\item[{void const $\ast$}]{value }\end{DoxyParamCaption})}



Set a pointer value in the hook context. 

Stores an application-\/specific pointer that can be retrieved by hooks. The lifetime of the pointed-\/to data must extend through the variation call.

EXAMPLE -\/ Open\+Telemetry span parent\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{hook__context_8h_a7a8d7d6a6046c3925628518e971bb3d7}{LDHookContext}} ctx = \mbox{\hyperlink{hook__context_8h_a6752ad02ed116d4f21a2dcb7a790f5a9}{LDHookContext\_New}}();}
\DoxyCodeLine{\mbox{\hyperlink{hook__context_8h_a68ab42283ecf0f6460169ffa2c80b858}{LDHookContext\_Set}}(ctx, \textcolor{stringliteral}{"{}span\_parent"{}}, my\_span\_context);}
\DoxyCodeLine{\textcolor{keywordtype}{bool} result = LDClientSDK\_BoolVariation\_WithHookContext(}
\DoxyCodeLine{    client, context, \textcolor{stringliteral}{"{}flag-\/key"{}}, \textcolor{keyword}{false}, ctx);}
\DoxyCodeLine{\mbox{\hyperlink{hook__context_8h_a643483a64077b2d3cc894828ddbd5591}{LDHookContext\_Free}}(ctx);}

\end{DoxyCode}



\begin{DoxyParams}{Parameters}
{\em hook\+\_\+context} & Hook context. Must not be NULL. \\
\hline
{\em key} & Key for the value. Must be null-\/terminated UTF-\/8 string. Must not be NULL. \\
\hline
{\em value} & Pointer to application data. May be NULL. Lifetime managed by caller -\/ must remain valid through the variation call. \\
\hline
\end{DoxyParams}
